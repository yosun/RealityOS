{
    "openapi": "3.0.4",
    "info": {
        "title": "Queue OpenAPI for fal-ai/sam-3/image",
        "version": "1.0.0",
        "description": "The OpenAPI schema for the fal-ai/sam-3/image queue.",
        "x-fal-metadata": {
            "endpointId": "fal-ai/sam-3/image",
            "category": "image-to-image",
            "thumbnailUrl": "https://v3b.fal.media/files/b/rabbit/kJhu6OfXaBwWYM1PUrWAL_6519f8ea79d649a9bead2e6118f4b997.jpg",
            "playgroundUrl": "https://fal.ai/models/fal-ai/sam-3/image",
            "documentationUrl": "https://fal.ai/models/fal-ai/sam-3/image/api"
        }
    },
    "components": {
        "securitySchemes": {
            "apiKeyAuth": {
                "type": "apiKey",
                "in": "header",
                "name": "Authorization",
                "description": "Fal Key"
            }
        },
        "schemas": {
            "QueueStatus": {
                "type": "object",
                "properties": {
                    "status": {
                        "type": "string",
                        "enum": [
                            "IN_QUEUE",
                            "IN_PROGRESS",
                            "COMPLETED"
                        ]
                    },
                    "request_id": {
                        "type": "string",
                        "description": "The request id."
                    },
                    "response_url": {
                        "type": "string",
                        "description": "The response url."
                    },
                    "status_url": {
                        "type": "string",
                        "description": "The status url."
                    },
                    "cancel_url": {
                        "type": "string",
                        "description": "The cancel url."
                    },
                    "logs": {
                        "type": "object",
                        "description": "The logs.",
                        "additionalProperties": true
                    },
                    "metrics": {
                        "type": "object",
                        "description": "The metrics.",
                        "additionalProperties": true
                    },
                    "queue_position": {
                        "type": "integer",
                        "description": "The queue position."
                    }
                },
                "required": [
                    "status",
                    "request_id"
                ]
            },
            "Sam3ImageInput": {
                "title": "SAM3ImageInput",
                "type": "object",
                "properties": {
                    "prompt": {
                        "description": "Text prompt for segmentation",
                        "type": "string",
                        "title": "Prompt",
                        "default": "wheel"
                    },
                    "include_boxes": {
                        "description": "Whether to include bounding boxes for each mask (when available).",
                        "type": "boolean",
                        "title": "Include Boxes",
                        "default": false
                    },
                    "return_multiple_masks": {
                        "description": "If True, upload and return multiple generated masks as defined by `max_masks`.",
                        "type": "boolean",
                        "title": "Return Multiple Masks",
                        "default": false
                    },
                    "output_format": {
                        "enum": [
                            "jpeg",
                            "png",
                            "webp"
                        ],
                        "description": "The format of the generated image.",
                        "type": "string",
                        "title": "Output Format",
                        "default": "png"
                    },
                    "image_url": {
                        "examples": [
                            "https://raw.githubusercontent.com/facebookresearch/segment-anything-2/main/notebooks/images/truck.jpg"
                        ],
                        "description": "URL of the image to be segmented",
                        "type": "string",
                        "title": "Image Url"
                    },
                    "sync_mode": {
                        "description": "If True, the media will be returned as a data URI.",
                        "type": "boolean",
                        "title": "Sync Mode",
                        "default": false
                    },
                    "point_prompts": {
                        "description": "List of point prompts",
                        "type": "array",
                        "title": "Point Prompts",
                        "items": {
                            "$ref": "#/components/schemas/PointPrompt"
                        },
                        "default": []
                    },
                    "include_scores": {
                        "description": "Whether to include mask confidence scores.",
                        "type": "boolean",
                        "title": "Include Scores",
                        "default": false
                    },
                    "max_masks": {
                        "minimum": 1,
                        "description": "Maximum number of masks to return when `return_multiple_masks` is enabled.",
                        "type": "integer",
                        "title": "Max Masks",
                        "maximum": 32,
                        "default": 3
                    },
                    "box_prompts": {
                        "description": "Box prompt coordinates (x_min, y_min, x_max, y_max). Multiple boxes supported - use object_id to group boxes for the same object or leave empty for separate objects.",
                        "type": "array",
                        "title": "Box Prompts",
                        "items": {
                            "$ref": "#/components/schemas/BoxPrompt"
                        },
                        "default": []
                    },
                    "apply_mask": {
                        "description": "Apply the mask on the image.",
                        "type": "boolean",
                        "title": "Apply Mask",
                        "default": true
                    },
                    "text_prompt": {
                        "description": "[DEPRECATED] Use 'prompt' instead. Kept for backward compatibility.",
                        "type": "string",
                        "title": "Text Prompt",
                        "deprecated": true
                    }
                },
                "x-fal-order-properties": [
                    "image_url",
                    "prompt",
                    "text_prompt",
                    "point_prompts",
                    "box_prompts",
                    "apply_mask",
                    "sync_mode",
                    "output_format",
                    "return_multiple_masks",
                    "max_masks",
                    "include_scores",
                    "include_boxes"
                ],
                "required": [
                    "image_url"
                ]
            },
            "Sam3ImageOutput": {
                "title": "SAM3ImageOutput",
                "type": "object",
                "properties": {
                    "image": {
                        "description": "Primary segmented mask preview.",
                        "title": "Image",
                        "allOf": [
                            {
                                "$ref": "#/components/schemas/Image"
                            }
                        ]
                    },
                    "metadata": {
                        "description": "Per-mask metadata including scores and boxes.",
                        "type": "array",
                        "title": "Metadata",
                        "items": {
                            "$ref": "#/components/schemas/MaskMetadata"
                        }
                    },
                    "masks": {
                        "description": "Segmented mask images.",
                        "type": "array",
                        "title": "Masks",
                        "items": {
                            "$ref": "#/components/schemas/Image"
                        }
                    },
                    "scores": {
                        "description": "Per-mask confidence scores when requested.",
                        "type": "array",
                        "title": "Scores",
                        "items": {
                            "type": "number"
                        }
                    },
                    "boxes": {
                        "description": "Per-mask normalized bounding boxes [cx, cy, w, h] when requested.",
                        "type": "array",
                        "title": "Boxes",
                        "items": {
                            "type": "array",
                            "items": {
                                "type": "number"
                            }
                        }
                    }
                },
                "x-fal-order-properties": [
                    "image",
                    "masks",
                    "metadata",
                    "scores",
                    "boxes"
                ],
                "required": [
                    "masks"
                ]
            },
            "PointPrompt": {
                "title": "PointPrompt",
                "type": "object",
                "properties": {
                    "object_id": {
                        "description": "Optional object identifier. Prompts sharing an object id refine the same object.",
                        "type": "integer",
                        "title": "Object Id"
                    },
                    "label": {
                        "enum": [
                            0,
                            1
                        ],
                        "description": "1 for foreground, 0 for background",
                        "type": "integer",
                        "title": "Label"
                    },
                    "y": {
                        "description": "Y Coordinate of the prompt",
                        "type": "integer",
                        "title": "Y"
                    },
                    "frame_index": {
                        "description": "The frame index to interact with.",
                        "type": "integer",
                        "title": "Frame Index"
                    },
                    "x": {
                        "description": "X Coordinate of the prompt",
                        "type": "integer",
                        "title": "X"
                    }
                },
                "x-fal-order-properties": [
                    "x",
                    "y",
                    "label",
                    "object_id",
                    "frame_index"
                ]
            },
            "BoxPrompt": {
                "title": "BoxPrompt",
                "type": "object",
                "properties": {
                    "y_min": {
                        "description": "Y Min Coordinate of the box",
                        "type": "integer",
                        "title": "Y Min"
                    },
                    "object_id": {
                        "description": "Optional object identifier. Boxes sharing an object id refine the same object.",
                        "type": "integer",
                        "title": "Object Id"
                    },
                    "frame_index": {
                        "description": "The frame index to interact with.",
                        "type": "integer",
                        "title": "Frame Index"
                    },
                    "x_max": {
                        "description": "X Max Coordinate of the box",
                        "type": "integer",
                        "title": "X Max"
                    },
                    "x_min": {
                        "description": "X Min Coordinate of the box",
                        "type": "integer",
                        "title": "X Min"
                    },
                    "y_max": {
                        "description": "Y Max Coordinate of the box",
                        "type": "integer",
                        "title": "Y Max"
                    }
                },
                "x-fal-order-properties": [
                    "x_min",
                    "y_min",
                    "x_max",
                    "y_max",
                    "object_id",
                    "frame_index"
                ]
            },
            "Image": {
                "description": "Represents an image file.",
                "type": "object",
                "x-fal-order-properties": [
                    "url",
                    "content_type",
                    "file_name",
                    "file_size",
                    "file_data",
                    "width",
                    "height"
                ],
                "title": "Image",
                "properties": {
                    "file_size": {
                        "examples": [
                            4404019
                        ],
                        "description": "The size of the file in bytes.",
                        "type": "integer",
                        "title": "File Size"
                    },
                    "height": {
                        "examples": [
                            1024
                        ],
                        "description": "The height of the image in pixels.",
                        "type": "integer",
                        "title": "Height"
                    },
                    "url": {
                        "description": "The URL where the file can be downloaded from.",
                        "type": "string",
                        "title": "Url"
                    },
                    "width": {
                        "examples": [
                            1024
                        ],
                        "description": "The width of the image in pixels.",
                        "type": "integer",
                        "title": "Width"
                    },
                    "file_name": {
                        "examples": [
                            "z9RV14K95DvU.png"
                        ],
                        "description": "The name of the file. It will be auto-generated if not provided.",
                        "type": "string",
                        "title": "File Name"
                    },
                    "content_type": {
                        "examples": [
                            "image/png"
                        ],
                        "description": "The mime type of the file.",
                        "type": "string",
                        "title": "Content Type"
                    },
                    "file_data": {
                        "format": "binary",
                        "description": "File data",
                        "type": "string",
                        "title": "File Data"
                    }
                },
                "required": [
                    "url"
                ]
            },
            "MaskMetadata": {
                "title": "MaskMetadata",
                "type": "object",
                "properties": {
                    "box": {
                        "description": "Bounding box for the mask in normalized cxcywh coordinates.",
                        "type": "array",
                        "title": "Box",
                        "items": {
                            "type": "number"
                        }
                    },
                    "index": {
                        "description": "Index of the mask inside the model output.",
                        "type": "integer",
                        "title": "Index"
                    },
                    "score": {
                        "description": "Score for this mask.",
                        "type": "number",
                        "title": "Score"
                    }
                },
                "x-fal-order-properties": [
                    "index",
                    "score",
                    "box"
                ],
                "required": [
                    "index"
                ]
            }
        }
    },
    "paths": {
        "/fal-ai/sam-3/image/requests/{request_id}/status": {
            "get": {
                "parameters": [
                    {
                        "name": "request_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "description": "Request ID"
                        }
                    },
                    {
                        "name": "logs",
                        "in": "query",
                        "required": false,
                        "schema": {
                            "type": "number",
                            "description": "Whether to include logs (`1`) in the response or not (`0`)."
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The request status.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/QueueStatus"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/fal-ai/sam-3/image/requests/{request_id}/cancel": {
            "put": {
                "parameters": [
                    {
                        "name": "request_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "description": "Request ID"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "The request was cancelled.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "type": "object",
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "description": "Whether the request was cancelled successfully."
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        },
        "/fal-ai/sam-3/image": {
            "post": {
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/Sam3ImageInput"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "The request status.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/QueueStatus"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/fal-ai/sam-3/image/requests/{request_id}": {
            "get": {
                "parameters": [
                    {
                        "name": "request_id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "description": "Request ID"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Result of the request.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/Sam3ImageOutput"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "servers": [
        {
            "url": "https://queue.fal.run"
        }
    ],
    "security": [
        {
            "apiKeyAuth": []
        }
    ]
}